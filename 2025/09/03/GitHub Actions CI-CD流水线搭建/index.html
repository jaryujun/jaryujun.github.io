<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä¸ºSpring Booté¡¹ç›®æ­å»ºä¸€å¥—å®Œæ•´çš„CI&#x2F;CDæµæ°´çº¿ï¼ŒåŒ…æ‹¬Dockerå®¹å™¨åŒ–ã€GitHub Actionsè‡ªåŠ¨åŒ–ã€ä»¥åŠé€šè¿‡è…¾è®¯äº‘é•œåƒåŠ é€Ÿè§£å†³ç½‘ç»œé—®é¢˜ã€‚ æ•´ä½“æ€è·¯GitHub Repository     â†“ (Push&#x2F;PR) GitHub Actions     â†“ (æ„å»ºã€æµ‹è¯•ã€è´¨é‡æ£€æŸ¥) Docker Registry (GitHub Container R">
<meta property="og:type" content="article">
<meta property="og:title" content="GitHub Actions CI-CDæµæ°´çº¿æ­å»º">
<meta property="og:url" content="https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/index.html">
<meta property="og:site_name" content="Jaryujun Blog">
<meta property="og:description" content="æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä¸ºSpring Booté¡¹ç›®æ­å»ºä¸€å¥—å®Œæ•´çš„CI&#x2F;CDæµæ°´çº¿ï¼ŒåŒ…æ‹¬Dockerå®¹å™¨åŒ–ã€GitHub Actionsè‡ªåŠ¨åŒ–ã€ä»¥åŠé€šè¿‡è…¾è®¯äº‘é•œåƒåŠ é€Ÿè§£å†³ç½‘ç»œé—®é¢˜ã€‚ æ•´ä½“æ€è·¯GitHub Repository     â†“ (Push&#x2F;PR) GitHub Actions     â†“ (æ„å»ºã€æµ‹è¯•ã€è´¨é‡æ£€æŸ¥) Docker Registry (GitHub Container R">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-09-03T05:51:50.000Z">
<meta property="article:modified_time" content="2026-02-26T00:47:21.026Z">
<meta property="article:author" content="Jaryujun">
<meta property="article:tag" content="CI&#x2F;CD">
<meta property="article:tag" content="Docker">
<meta property="article:tag" content="GitHub Actions">
<meta property="article:tag" content="Spring Boot">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>GitHub Actions CI-CDæµæ°´çº¿æ­å»º</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 8.1.1"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/briefing/">Briefing</a></li><!--
     --><!--
       --><li><a href="/projects/">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2025/11/01/%E5%AF%B9%E9%AB%98%E9%80%9F%E5%8F%91%E5%B1%95%E9%98%B6%E6%AE%B5%E7%9A%84%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84%E6%B2%BB%E7%90%86%E7%AD%96%E7%95%A5%E7%9A%84%E6%80%9D%E8%80%83/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/09/02/%E7%94%B3%E8%AF%B7-Apple-Developer-%E5%BC%80%E5%8F%91%E8%AF%81%E4%B9%A6/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&text=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&is_video=false&description=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=GitHub Actions CI-CDæµæ°´çº¿æ­å»º&body=Check out this article: https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&name=GitHub Actions CI-CDæµæ°´çº¿æ­å»º&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&t=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E6%80%9D%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text">æ•´ä½“æ€è·¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">ğŸš€ æ ¸å¿ƒç»„ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Docker%E5%AE%B9%E5%99%A8%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-number">2.1.</span> <span class="toc-text">1. Dockerå®¹å™¨åŒ–ç­–ç•¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E9%98%B6%E6%AE%B5%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">2.1.1.</span> <span class="toc-text">å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker-Compose%E6%9C%8D%E5%8A%A1%E7%BC%96%E6%8E%92"><span class="toc-number">2.1.2.</span> <span class="toc-text">Docker ComposeæœåŠ¡ç¼–æ’</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-GitHub-Actions%E5%B7%A5%E4%BD%9C%E6%B5%81"><span class="toc-number">2.2.</span> <span class="toc-text">2. GitHub Actionså·¥ä½œæµ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD-%E8%A7%A3%E5%86%B3%E7%9A%84%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF%E9%97%AE%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text">ï¿½ï¿½ è§£å†³çš„å…³é”®æŠ€æœ¯é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98"><span class="toc-number">3.1.</span> <span class="toc-text">1. ç½‘ç»œè¿æ¥é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Maven%E4%BE%9D%E8%B5%96%E4%B8%8B%E8%BD%BD%E4%BC%98%E5%8C%96"><span class="toc-number">3.2.</span> <span class="toc-text">2. Mavenä¾èµ–ä¸‹è½½ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Docker%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">3.3.</span> <span class="toc-text">3. Dockeræ„å»ºä¼˜åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD-%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87%E5%AF%B9%E6%AF%94"><span class="toc-number">4.</span> <span class="toc-text">ï¿½ï¿½ æ€§èƒ½æå‡å¯¹æ¯”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD%EF%B8%8F-%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC"><span class="toc-number">5.</span> <span class="toc-text">ï¿½ï¿½ï¸ éƒ¨ç½²è„šæœ¬</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC"><span class="toc-number">5.1.</span> <span class="toc-text">ä¸€é”®éƒ¨ç½²è„šæœ¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5%E8%84%9A%E6%9C%AC"><span class="toc-number">5.2.</span> <span class="toc-text">å¥åº·æ£€æŸ¥è„šæœ¬</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97"><span class="toc-number">6.</span> <span class="toc-text">ğŸš€ ä½¿ç”¨æŒ‡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">6.1.</span> <span class="toc-text">1. ç¯å¢ƒå‡†å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A6%81%E6%B1%82"><span class="toc-number">6.1.1.</span> <span class="toc-text">æœåŠ¡å™¨è¦æ±‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Docker"><span class="toc-number">6.1.2.</span> <span class="toc-text">å®‰è£…Docker</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">6.2.</span> <span class="toc-text">2. é…ç½®ç¯å¢ƒå˜é‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">6.2.1.</span> <span class="toc-text">åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEGitHub-Secrets"><span class="toc-number">6.2.2.</span> <span class="toc-text">é…ç½®GitHub Secrets</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%A6%96%E6%AC%A1%E9%83%A8%E7%BD%B2"><span class="toc-number">6.3.</span> <span class="toc-text">3. é¦–æ¬¡éƒ¨ç½²</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2"><span class="toc-number">6.4.</span> <span class="toc-text">4. è‡ªåŠ¨åŒ–éƒ¨ç½²</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%88-%E7%9B%91%E6%8E%A7%E5%92%8C%E6%97%A5%E5%BF%97"><span class="toc-number">7.</span> <span class="toc-text">ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%9B%91%E6%8E%A7"><span class="toc-number">7.1.</span> <span class="toc-text">åº”ç”¨ç›‘æ§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%9F%A5%E7%9C%8B"><span class="toc-number">7.2.</span> <span class="toc-text">æ—¥å¿—æŸ¥çœ‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7"><span class="toc-number">7.3.</span> <span class="toc-text">èµ„æºç›‘æ§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%90-%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">8.</span> <span class="toc-text">ğŸ” å®‰å…¨å»ºè®®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AE%89%E5%85%A8"><span class="toc-number">8.1.</span> <span class="toc-text">1. ç¯å¢ƒå˜é‡å®‰å…¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8"><span class="toc-number">8.2.</span> <span class="toc-text">2. ç½‘ç»œå®‰å…¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8"><span class="toc-number">8.3.</span> <span class="toc-text">3. å®¹å™¨å®‰å…¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD-%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">ï¿½ï¿½ æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%85-%E6%8A%80%E6%9C%AF%E6%88%90%E6%9E%9C"><span class="toc-number">9.1.</span> <span class="toc-text">âœ… æŠ€æœ¯æˆæœ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%85-%E8%BF%90%E7%BB%B4%E6%88%90%E6%9E%9C"><span class="toc-number">9.2.</span> <span class="toc-text">âœ… è¿ç»´æˆæœ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%85-%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C"><span class="toc-number">9.3.</span> <span class="toc-text">âœ… å¼€å‘ä½“éªŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD-%E4%B8%8B%E4%B8%80%E6%AD%A5%E4%BC%98%E5%8C%96%E6%96%B9%E5%90%91"><span class="toc-number">9.4.</span> <span class="toc-text">ï¿½ï¿½ ä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        GitHub Actions CI-CDæµæ°´çº¿æ­å»º
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Jaryujun</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-09-03T05:51:50.000Z" class="dt-published" itemprop="datePublished">2025-09-03</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CI-CD/" rel="tag">CI/CD</a>, <a class="p-category" href="/tags/Docker/" rel="tag">Docker</a>, <a class="p-category" href="/tags/GitHub-Actions/" rel="tag">GitHub Actions</a>, <a class="p-category" href="/tags/Spring-Boot/" rel="tag">Spring Boot</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <p>æœ¬æ–‡å°†è¯¦ç»†ä»‹ç»å¦‚ä½•ä¸ºSpring Booté¡¹ç›®æ­å»ºä¸€å¥—å®Œæ•´çš„CI&#x2F;CDæµæ°´çº¿ï¼ŒåŒ…æ‹¬Dockerå®¹å™¨åŒ–ã€GitHub Actionsè‡ªåŠ¨åŒ–ã€ä»¥åŠé€šè¿‡è…¾è®¯äº‘é•œåƒåŠ é€Ÿè§£å†³ç½‘ç»œé—®é¢˜ã€‚</p>
<h2 id="æ•´ä½“æ€è·¯"><a href="#æ•´ä½“æ€è·¯" class="headerlink" title="æ•´ä½“æ€è·¯"></a>æ•´ä½“æ€è·¯</h2><pre><code class="highlight plaintext">GitHub Repository
    â†“ (Push/PR)
GitHub Actions
    â†“ (æ„å»ºã€æµ‹è¯•ã€è´¨é‡æ£€æŸ¥)
Docker Registry (GitHub Container Registry)
    â†“ (éƒ¨ç½²)
ç”Ÿäº§ç¯å¢ƒ (Docker Compose + Nginx)
    â†“ (ç›‘æ§)
Spring Boot Actuator + å¥åº·æ£€æŸ¥</code></pre>

<h2 id="ğŸš€-æ ¸å¿ƒç»„ä»¶"><a href="#ğŸš€-æ ¸å¿ƒç»„ä»¶" class="headerlink" title="ğŸš€ æ ¸å¿ƒç»„ä»¶"></a>ğŸš€ æ ¸å¿ƒç»„ä»¶</h2><h3 id="1-Dockerå®¹å™¨åŒ–ç­–ç•¥"><a href="#1-Dockerå®¹å™¨åŒ–ç­–ç•¥" class="headerlink" title="1. Dockerå®¹å™¨åŒ–ç­–ç•¥"></a>1. Dockerå®¹å™¨åŒ–ç­–ç•¥</h3><h4 id="å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–"><a href="#å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–" class="headerlink" title="å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–"></a>å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–</h4><pre><code class="highlight dockerfile"><span class="comment"># å¤šé˜¶æ®µæ„å»º - æ„å»ºé˜¶æ®µ</span>
<span class="keyword">FROM</span> maven:<span class="number">3.9</span>.<span class="number">4</span>-eclipse-temurin-<span class="number">17</span>-alpine AS build

<span class="comment"># è®¾ç½®å·¥ä½œç›®å½•</span>
<span class="keyword">WORKDIR</span><span class="language-bash"> /app</span>

<span class="comment"># é…ç½®Mavenä½¿ç”¨è…¾è®¯äº‘é•œåƒæºï¼ˆåˆ©ç”¨Dockerå±‚ç¼“å­˜ï¼‰</span>
<span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /root/.m2 &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#x27;</span> &gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;&lt;settings xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;          xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;          xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;  &lt;mirrors&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;    &lt;mirror&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;      &lt;id&gt;tencentmaven&lt;/id&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;      &lt;mirrorOf&gt;*&lt;/mirrorOf&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;      &lt;name&gt;è…¾è®¯äº‘å…¬å…±ä»“åº“&lt;/name&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;      &lt;url&gt;https://mirrors.cloud.tencent.com/nexus/repository/maven-public/&lt;/url&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;    &lt;/mirror&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;  &lt;/mirrors&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml &amp;&amp; \</span>
<span class="language-bash">    <span class="built_in">echo</span> <span class="string">&#x27;&lt;/settings&gt;&#x27;</span> &gt;&gt; /root/.m2/settings.xml</span>

<span class="comment"># å…ˆå¤åˆ¶pom.xmlæ–‡ä»¶ï¼ˆåˆ©ç”¨Dockerå±‚ç¼“å­˜ï¼‰</span>
<span class="keyword">COPY</span><span class="language-bash"> backend/pom.xml .</span>

<span class="comment"># ä¸‹è½½ä¾èµ–ï¼ˆåˆ©ç”¨Dockerç¼“å­˜ï¼Œåªæœ‰pom.xmlå˜åŒ–æ—¶æ‰é‡æ–°ä¸‹è½½ï¼‰</span>
<span class="keyword">RUN</span><span class="language-bash"> mvn dependency:go-offline -B</span>

<span class="comment"># å¤åˆ¶æºä»£ç ï¼ˆåªæœ‰æºä»£ç å˜åŒ–æ—¶æ‰é‡æ–°æ„å»ºï¼‰</span>
<span class="keyword">COPY</span><span class="language-bash"> backend/src ./src</span>

<span class="comment"># æ„å»ºåº”ç”¨</span>
<span class="keyword">RUN</span><span class="language-bash"> mvn clean package -DskipTests</span>

<span class="comment"># è¿è¡Œé˜¶æ®µ</span>
<span class="keyword">FROM</span> eclipse-temurin:<span class="number">17</span>-jre-alpine

<span class="comment"># å®‰è£…å¿…è¦çš„å·¥å…·</span>
<span class="keyword">RUN</span><span class="language-bash"> apk add --no-cache \</span>
<span class="language-bash">    curl \</span>
<span class="language-bash">    bash</span>

<span class="comment"># åˆ›å»ºåº”ç”¨ç”¨æˆ·</span>
<span class="keyword">RUN</span><span class="language-bash"> addgroup -g 1000 appuser &amp;&amp; adduser -D -s /bin/bash -u 1000 -G appuser appuser</span>

<span class="comment"># è®¾ç½®å·¥ä½œç›®å½•</span>
<span class="keyword">WORKDIR</span><span class="language-bash"> /app</span>

<span class="comment"># ä»æ„å»ºé˜¶æ®µå¤åˆ¶jaræ–‡ä»¶</span>
<span class="keyword">COPY</span><span class="language-bash"> --from=build /app/target/teacher-on-call-*.jar app.jar</span>

<span class="comment"># åˆ›å»ºæ—¥å¿—ç›®å½•</span>
<span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /app/logs &amp;&amp; <span class="built_in">chown</span> -R appuser:appuser /app</span>

<span class="comment"># åˆ‡æ¢åˆ°åº”ç”¨ç”¨æˆ·</span>
<span class="keyword">USER</span> appuser

<span class="comment"># æš´éœ²ç«¯å£</span>
<span class="keyword">EXPOSE</span> <span class="number">8080</span>

<span class="comment"># å¥åº·æ£€æŸ¥</span>
<span class="keyword">HEALTHCHECK</span><span class="language-bash"> --interval=30s --<span class="built_in">timeout</span>=10s --start-period=60s --retries=3 \</span>
<span class="language-bash">    CMD curl -f http://localhost:8080/api/actuator/health || <span class="built_in">exit</span> 1</span>

<span class="comment"># å¯åŠ¨åº”ç”¨</span>
<span class="keyword">ENTRYPOINT</span><span class="language-bash"> [<span class="string">&quot;java&quot;</span>, <span class="string">&quot;-jar&quot;</span>, <span class="string">&quot;app.jar&quot;</span>]</span></code></pre>

<h4 id="Docker-ComposeæœåŠ¡ç¼–æ’"><a href="#Docker-ComposeæœåŠ¡ç¼–æ’" class="headerlink" title="Docker ComposeæœåŠ¡ç¼–æ’"></a>Docker ComposeæœåŠ¡ç¼–æ’</h4><pre><code class="highlight yaml"><span class="attr">version:</span> <span class="string">&#x27;3.8&#x27;</span>

<span class="attr">services:</span>
  <span class="comment"># åç«¯åº”ç”¨</span>
  <span class="attr">backend:</span>
    <span class="attr">build:</span>
      <span class="attr">context:</span> <span class="string">..</span>
      <span class="attr">dockerfile:</span> <span class="string">docker/Dockerfile</span>
    <span class="attr">container_name:</span> <span class="string">teacher-on-call-backend</span>
    <span class="attr">ports:</span>
      <span class="bullet">-</span> <span class="string">&quot;8080:8080&quot;</span>
    <span class="attr">environment:</span>
      <span class="bullet">-</span> <span class="string">SPRING_PROFILES_ACTIVE=prod</span>
      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_URL=jdbc:mysql://mysql:3306/teacher_on_call?serverTimezone=Asia/Shanghai&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false</span>
      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_USERNAME=$&#123;DB_USERNAME:-teacher_on_call&#125;</span>
      <span class="bullet">-</span> <span class="string">SPRING_DATASOURCE_PASSWORD=$&#123;DB_PASSWORD:-password123&#125;</span>
      <span class="bullet">-</span> <span class="string">SPRING_REDIS_HOST=redis</span>
      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PORT=6379</span>
      <span class="bullet">-</span> <span class="string">SPRING_REDIS_PASSWORD=$&#123;REDIS_PASSWORD:-redis123&#125;</span>
      <span class="bullet">-</span> <span class="string">JWT_SECRET=$&#123;JWT_SECRET:-teacherOnCallJwtSecretKey2024ForHS512AlgorithmMustBe64BytesOrMore&#125;</span>
      <span class="bullet">-</span> <span class="string">SECURITY_ENCRYPT_KEY=$&#123;SECURITY_ENCRYPT_KEY:-teacherOnCallEncryptKey123456789012&#125;</span>
    <span class="attr">depends_on:</span>
      <span class="attr">mysql:</span>
        <span class="attr">condition:</span> <span class="string">service_healthy</span>
      <span class="attr">redis:</span>
        <span class="attr">condition:</span> <span class="string">service_healthy</span>
    <span class="attr">networks:</span>
      <span class="bullet">-</span> <span class="string">teacher-network</span>
    <span class="attr">restart:</span> <span class="string">unless-stopped</span>
    <span class="attr">volumes:</span>
      <span class="bullet">-</span> <span class="string">app-logs:/app/logs</span>
    <span class="attr">healthcheck:</span>
      <span class="attr">test:</span> [<span class="string">&quot;CMD&quot;</span>, <span class="string">&quot;curl&quot;</span>, <span class="string">&quot;-f&quot;</span>, <span class="string">&quot;http://localhost:8080/api/actuator/health&quot;</span>]
      <span class="attr">interval:</span> <span class="string">30s</span>
      <span class="attr">timeout:</span> <span class="string">10s</span>
      <span class="attr">retries:</span> <span class="number">3</span>
      <span class="attr">start_period:</span> <span class="string">60s</span>

  <span class="comment"># MySQLæ•°æ®åº“</span>
  <span class="attr">mysql:</span>
    <span class="attr">image:</span> <span class="string">mysql:8.0</span>
    <span class="attr">container_name:</span> <span class="string">teacher-on-call-mysql</span>
    <span class="attr">ports:</span>
      <span class="bullet">-</span> <span class="string">&quot;3306:3306&quot;</span>
    <span class="attr">environment:</span>
      <span class="bullet">-</span> <span class="string">MYSQL_ROOT_PASSWORD=$&#123;DB_ROOT_PASSWORD:-root123&#125;</span>
      <span class="bullet">-</span> <span class="string">MYSQL_DATABASE=teacher_on_call</span>
      <span class="bullet">-</span> <span class="string">MYSQL_USER=$&#123;DB_USERNAME:-teacher_on_call&#125;</span>
      <span class="bullet">-</span> <span class="string">MYSQL_PASSWORD=$&#123;DB_PASSWORD:-password123&#125;</span>
    <span class="attr">volumes:</span>
      <span class="bullet">-</span> <span class="string">mysql-data:/var/lib/mysql</span>
      <span class="bullet">-</span> <span class="string">./init.sql:/docker-entrypoint-initdb.d/init.sql:ro</span>
    <span class="attr">networks:</span>
      <span class="bullet">-</span> <span class="string">teacher-network</span>
    <span class="attr">restart:</span> <span class="string">unless-stopped</span>
    <span class="attr">healthcheck:</span>
      <span class="attr">test:</span> [<span class="string">&quot;CMD&quot;</span>, <span class="string">&quot;mysqladmin&quot;</span>, <span class="string">&quot;ping&quot;</span>, <span class="string">&quot;-h&quot;</span>, <span class="string">&quot;localhost&quot;</span>]
      <span class="attr">interval:</span> <span class="string">30s</span>
      <span class="attr">timeout:</span> <span class="string">10s</span>
      <span class="attr">retries:</span> <span class="number">5</span>
      <span class="attr">start_period:</span> <span class="string">30s</span>

  <span class="comment"># Redisç¼“å­˜</span>
  <span class="attr">redis:</span>
    <span class="attr">image:</span> <span class="string">redis:7-alpine</span>
    <span class="attr">container_name:</span> <span class="string">teacher-on-call-redis</span>
    <span class="attr">ports:</span>
      <span class="bullet">-</span> <span class="string">&quot;6379:6379&quot;</span>
    <span class="attr">command:</span> <span class="string">redis-server</span> <span class="string">--requirepass</span> <span class="string">$&#123;REDIS_PASSWORD:-redis123&#125;</span>
    <span class="attr">volumes:</span>
      <span class="bullet">-</span> <span class="string">redis-data:/data</span>
    <span class="attr">networks:</span>
      <span class="bullet">-</span> <span class="string">teacher-network</span>
    <span class="attr">restart:</span> <span class="string">unless-stopped</span>
    <span class="attr">healthcheck:</span>
      <span class="attr">test:</span> [<span class="string">&quot;CMD&quot;</span>, <span class="string">&quot;redis-cli&quot;</span>, <span class="string">&quot;--raw&quot;</span>, <span class="string">&quot;incr&quot;</span>, <span class="string">&quot;ping&quot;</span>]
      <span class="attr">interval:</span> <span class="string">30s</span>
      <span class="attr">timeout:</span> <span class="string">10s</span>
      <span class="attr">retries:</span> <span class="number">3</span>
      <span class="attr">start_period:</span> <span class="string">30s</span>

<span class="attr">volumes:</span>
  <span class="attr">mysql-data:</span>
  <span class="attr">redis-data:</span>
  <span class="attr">app-logs:</span>

<span class="attr">networks:</span>
  <span class="attr">teacher-network:</span>
    <span class="attr">driver:</span> <span class="string">bridge</span></code></pre>

<h3 id="2-GitHub-Actionså·¥ä½œæµ"><a href="#2-GitHub-Actionså·¥ä½œæµ" class="headerlink" title="2. GitHub Actionså·¥ä½œæµ"></a>2. GitHub Actionså·¥ä½œæµ</h3><pre><code class="highlight yaml"><span class="attr">name:</span> <span class="string">Backend</span> <span class="string">CI/CD</span>

<span class="attr">on:</span>
  <span class="attr">push:</span>
    <span class="attr">branches:</span> [ <span class="string">main</span> ]
    <span class="attr">paths:</span>
      <span class="bullet">-</span> <span class="string">&#x27;backend/**&#x27;</span>
      <span class="bullet">-</span> <span class="string">&#x27;docker/**&#x27;</span>
      <span class="bullet">-</span> <span class="string">&#x27;.github/workflows/backend-ci-cd.yml&#x27;</span>
  <span class="attr">pull_request:</span>
    <span class="attr">branches:</span> [ <span class="string">main</span> ]
    <span class="attr">paths:</span>
      <span class="bullet">-</span> <span class="string">&#x27;backend/**&#x27;</span>
      <span class="bullet">-</span> <span class="string">&#x27;docker/**&#x27;</span>
      <span class="bullet">-</span> <span class="string">&#x27;.github/workflows/backend-ci-cd.yml&#x27;</span>

<span class="attr">env:</span>
  <span class="attr">REGISTRY:</span> <span class="string">ghcr.io</span>
  <span class="attr">IMAGE_NAME:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.repository</span> <span class="string">&#125;&#125;/teacher-on-call-backend</span>

<span class="attr">jobs:</span>
  <span class="comment"># æ„å»ºå’Œæµ‹è¯•</span>
  <span class="attr">build-and-test:</span>
    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span>
    
    <span class="attr">steps:</span>
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">code</span>
      <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span>
      
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">up</span> <span class="string">JDK</span> <span class="number">17</span>
      <span class="attr">uses:</span> <span class="string">actions/setup-java@v4</span>
      <span class="attr">with:</span>
        <span class="attr">java-version:</span> <span class="string">&#x27;17&#x27;</span>
        <span class="attr">distribution:</span> <span class="string">&#x27;temurin&#x27;</span>
        
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Cache</span> <span class="string">Maven</span> <span class="string">dependencies</span>
      <span class="attr">uses:</span> <span class="string">actions/cache@v3</span>
      <span class="attr">with:</span>
        <span class="attr">path:</span> <span class="string">~/.m2</span>
        <span class="attr">key:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.os</span> <span class="string">&#125;&#125;-m2-$&#123;&#123;</span> <span class="string">hashFiles(&#x27;**/pom.xml&#x27;)</span> <span class="string">&#125;&#125;</span>
        <span class="attr">restore-keys:</span> <span class="string">$&#123;&#123;</span> <span class="string">runner.os</span> <span class="string">&#125;&#125;-m2</span>
        
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Run</span> <span class="string">tests</span>
      <span class="attr">run:</span> <span class="string">|</span>
<span class="string">        cd backend</span>
<span class="string">        mvn clean test</span>
<span class="string"></span>        
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">application</span>
      <span class="attr">run:</span> <span class="string">|</span>
<span class="string">        cd backend</span>
<span class="string">        mvn clean package -DskipTests</span>
<span class="string"></span>        
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Upload</span> <span class="string">build</span> <span class="string">artifacts</span>
      <span class="attr">uses:</span> <span class="string">actions/upload-artifact@v3</span>
      <span class="attr">with:</span>
        <span class="attr">name:</span> <span class="string">backend-jar</span>
        <span class="attr">path:</span> <span class="string">backend/target/*.jar</span>

  <span class="comment"># æ„å»ºDockeré•œåƒ</span>
  <span class="attr">build-docker:</span>
    <span class="attr">needs:</span> <span class="string">build-and-test</span>
    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span>
    <span class="attr">if:</span> <span class="string">github.ref</span> <span class="string">==</span> <span class="string">&#x27;refs/heads/main&#x27;</span>
    
    <span class="attr">steps:</span>
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">code</span>
      <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span>
      
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Set</span> <span class="string">up</span> <span class="string">Docker</span> <span class="string">Buildx</span>
      <span class="attr">uses:</span> <span class="string">docker/setup-buildx-action@v3</span>
      
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Log</span> <span class="string">in</span> <span class="string">to</span> <span class="string">Container</span> <span class="string">Registry</span>
      <span class="attr">uses:</span> <span class="string">docker/login-action@v3</span>
      <span class="attr">with:</span>
        <span class="attr">registry:</span> <span class="string">$&#123;&#123;</span> <span class="string">env.REGISTRY</span> <span class="string">&#125;&#125;</span>
        <span class="attr">username:</span> <span class="string">$&#123;&#123;</span> <span class="string">github.actor</span> <span class="string">&#125;&#125;</span>
        <span class="attr">password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.GITHUB_TOKEN</span> <span class="string">&#125;&#125;</span>
        
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Extract</span> <span class="string">metadata</span>
      <span class="attr">id:</span> <span class="string">meta</span>
      <span class="attr">uses:</span> <span class="string">docker/metadata-action@v5</span>
      <span class="attr">with:</span>
        <span class="attr">images:</span> <span class="string">$&#123;&#123;</span> <span class="string">env.REGISTRY</span> <span class="string">&#125;&#125;/$&#123;&#123;</span> <span class="string">env.IMAGE_NAME</span> <span class="string">&#125;&#125;</span>
        <span class="attr">tags:</span> <span class="string">|</span>
<span class="string">          type=ref,event=branch</span>
<span class="string">          type=ref,event=pr</span>
<span class="string">          type=sha,prefix=&#123;&#123;branch&#125;&#125;-</span>
<span class="string">          type=raw,value=latest,enable=&#123;&#123;is_default_branch&#125;&#125;</span>
<span class="string"></span>          
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Build</span> <span class="string">and</span> <span class="string">push</span> <span class="string">Docker</span> <span class="string">image</span>
      <span class="attr">uses:</span> <span class="string">docker/build-push-action@v5</span>
      <span class="attr">with:</span>
        <span class="attr">context:</span> <span class="string">.</span>
        <span class="attr">file:</span> <span class="string">./docker/Dockerfile</span>
        <span class="attr">push:</span> <span class="literal">true</span>
        <span class="attr">tags:</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.meta.outputs.tags</span> <span class="string">&#125;&#125;</span>
        <span class="attr">labels:</span> <span class="string">$&#123;&#123;</span> <span class="string">steps.meta.outputs.labels</span> <span class="string">&#125;&#125;</span>
        <span class="attr">cache-from:</span> <span class="string">type=gha</span>
        <span class="attr">cache-to:</span> <span class="string">type=gha,mode=max</span>

  <span class="comment"># éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ</span>
  <span class="attr">deploy:</span>
    <span class="attr">needs:</span> <span class="string">build-docker</span>
    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span>
    <span class="attr">if:</span> <span class="string">github.ref</span> <span class="string">==</span> <span class="string">&#x27;refs/heads/main&#x27;</span>
    
    <span class="attr">steps:</span>
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Checkout</span> <span class="string">code</span>
      <span class="attr">uses:</span> <span class="string">actions/checkout@v4</span>
      
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Deploy</span> <span class="string">to</span> <span class="string">production</span>
      <span class="attr">uses:</span> <span class="string">appleboy/ssh-action@v1.0.0</span>
      <span class="attr">with:</span>
        <span class="attr">host:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.HOST</span> <span class="string">&#125;&#125;</span>
        <span class="attr">username:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.USERNAME</span> <span class="string">&#125;&#125;</span>
        <span class="attr">password:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.PASSWORD</span> <span class="string">&#125;&#125;</span>
        <span class="attr">port:</span> <span class="string">$&#123;&#123;</span> <span class="string">secrets.PORT</span> <span class="string">&#125;&#125;</span>
        <span class="attr">script:</span> <span class="string">|</span>
<span class="string">          # è¿›å…¥é¡¹ç›®ç›®å½•</span>
<span class="string">          cd /opt/teacher-on-call</span>
<span class="string"></span>          
          <span class="comment"># æ‹‰å–æœ€æ–°ä»£ç </span>
          <span class="string">git</span> <span class="string">pull</span> <span class="string">origin</span> <span class="string">main</span>
          
          <span class="comment"># åœæ­¢ç°æœ‰æœåŠ¡</span>
          <span class="string">docker-compose</span> <span class="string">-f</span> <span class="string">docker/docker-compose.yml</span> <span class="string">down</span>
          
          <span class="comment"># æ‹‰å–æœ€æ–°é•œåƒ</span>
          <span class="string">docker-compose</span> <span class="string">-f</span> <span class="string">docker/docker-compose.yml</span> <span class="string">pull</span> <span class="string">backend</span>
          
          <span class="comment"># å¯åŠ¨æœåŠ¡</span>
          <span class="string">docker-compose</span> <span class="string">-f</span> <span class="string">docker/docker-compose.yml</span> <span class="string">up</span> <span class="string">-d</span>
          
          <span class="comment"># ç­‰å¾…æœåŠ¡å¯åŠ¨</span>
          <span class="string">sleep</span> <span class="number">30</span>
          
          <span class="comment"># å¥åº·æ£€æŸ¥</span>
          <span class="string">./scripts/health-check.sh</span>
          
    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Notify</span> <span class="string">deployment</span> <span class="string">status</span>
      <span class="attr">if:</span> <span class="string">always()</span>
      <span class="attr">run:</span> <span class="string">|</span>
<span class="string">        if [ &quot;$&#123;&#123; job.status &#125;&#125;&quot; == &quot;success&quot; ]; then</span>
<span class="string">          echo &quot;âœ… éƒ¨ç½²æˆåŠŸï¼&quot;</span>
<span class="string">        else</span>
<span class="string">          echo &quot;âŒ éƒ¨ç½²å¤±è´¥ï¼&quot;</span>
<span class="string">        fi</span></code></pre>

<h2 id="ï¿½ï¿½-è§£å†³çš„å…³é”®æŠ€æœ¯é—®é¢˜"><a href="#ï¿½ï¿½-è§£å†³çš„å…³é”®æŠ€æœ¯é—®é¢˜" class="headerlink" title="ï¿½ï¿½ è§£å†³çš„å…³é”®æŠ€æœ¯é—®é¢˜"></a>ï¿½ï¿½ è§£å†³çš„å…³é”®æŠ€æœ¯é—®é¢˜</h2><h3 id="1-ç½‘ç»œè¿æ¥é—®é¢˜"><a href="#1-ç½‘ç»œè¿æ¥é—®é¢˜" class="headerlink" title="1. ç½‘ç»œè¿æ¥é—®é¢˜"></a>1. ç½‘ç»œè¿æ¥é—®é¢˜</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šå›½å†…æœåŠ¡å™¨è®¿é—®Docker Hubè¶…æ—¶ï¼Œé•œåƒæ‹‰å–å¤±è´¥</p>
<pre><code class="highlight plaintext">failed to solve: DeadlineExceeded: maven:3.9.4-openjdk-17-slim: 
failed to do request: Head &quot;https://registry-1.docker.io/v2/library/maven/manifests/3.9.4-openjdk-17-slim&quot;: 
dial tcp 108.160.170.41:443: i/o timeout</code></pre>

<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé…ç½®è…¾è®¯äº‘é•œåƒåŠ é€Ÿå™¨</p>
<pre><code class="highlight json"><span class="punctuation">&#123;</span>
  <span class="attr">&quot;registry-mirrors&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>
    <span class="string">&quot;https://mirror.ccs.tencentyun.com&quot;</span>
  <span class="punctuation">]</span>
<span class="punctuation">&#125;</span></code></pre>

<p><strong>æ•ˆæœ</strong>ï¼šé•œåƒæ‹‰å–é€Ÿåº¦ä»è¶…æ—¶å¤±è´¥æå‡åˆ°30ç§’å†…å®Œæˆ</p>
<h3 id="2-Mavenä¾èµ–ä¸‹è½½ä¼˜åŒ–"><a href="#2-Mavenä¾èµ–ä¸‹è½½ä¼˜åŒ–" class="headerlink" title="2. Mavenä¾èµ–ä¸‹è½½ä¼˜åŒ–"></a>2. Mavenä¾èµ–ä¸‹è½½ä¼˜åŒ–</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šMavenä¾èµ–ä¸‹è½½ç¼“æ…¢ï¼Œæ„å»ºæ—¶é—´é•¿</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨è…¾è®¯äº‘Mavené•œåƒæº</p>
<pre><code class="highlight xml"><span class="tag">&lt;<span class="name">mirror</span>&gt;</span>
  <span class="tag">&lt;<span class="name">id</span>&gt;</span>tencentmaven<span class="tag">&lt;/<span class="name">id</span>&gt;</span>
  <span class="tag">&lt;<span class="name">mirrorOf</span>&gt;</span>*<span class="tag">&lt;/<span class="name">mirrorOf</span>&gt;</span>
  <span class="tag">&lt;<span class="name">name</span>&gt;</span>è…¾è®¯äº‘å…¬å…±ä»“åº“<span class="tag">&lt;/<span class="name">name</span>&gt;</span>
  <span class="tag">&lt;<span class="name">url</span>&gt;</span>https://mirrors.cloud.tencent.com/nexus/repository/maven-public/<span class="tag">&lt;/<span class="name">url</span>&gt;</span>
<span class="tag">&lt;/<span class="name">mirror</span>&gt;</span></code></pre>

<p><strong>æ•ˆæœ</strong>ï¼šMavenä¾èµ–ä¸‹è½½é€Ÿåº¦æå‡3-5å€</p>
<h3 id="3-Dockeræ„å»ºä¼˜åŒ–"><a href="#3-Dockeræ„å»ºä¼˜åŒ–" class="headerlink" title="3. Dockeræ„å»ºä¼˜åŒ–"></a>3. Dockeræ„å»ºä¼˜åŒ–</h3><p><strong>é—®é¢˜æè¿°</strong>ï¼šDockeræ„å»ºè¿‡ç¨‹ç¼“æ…¢ï¼Œç¼“å­˜æ•ˆæœå·®</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä¼˜åŒ–Dockerfileå±‚ç¼“å­˜ç»“æ„</p>
<pre><code class="highlight dockerfile"><span class="comment"># å…ˆé…ç½®Mavené•œåƒæºï¼ˆç¼“å­˜å±‚ï¼‰</span>
<span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">mkdir</span> -p /root/.m2 &amp;&amp; <span class="built_in">echo</span> <span class="string">&#x27;...&#x27;</span> &gt; /root/.m2/settings.xml</span>

<span class="comment"># å…ˆå¤åˆ¶pom.xmlæ–‡ä»¶ï¼ˆç¼“å­˜å±‚ï¼‰</span>
<span class="keyword">COPY</span><span class="language-bash"> backend/pom.xml .</span>

<span class="comment"># ä¸‹è½½ä¾èµ–ï¼ˆç¼“å­˜å±‚ï¼‰</span>
<span class="keyword">RUN</span><span class="language-bash"> mvn dependency:go-offline -B</span>

<span class="comment"># æœ€åå¤åˆ¶æºä»£ç ï¼ˆå˜åŒ–å±‚ï¼‰</span>
<span class="keyword">COPY</span><span class="language-bash"> backend/src ./src</span></code></pre>

<p><strong>æ•ˆæœ</strong>ï¼šé‡å¤æ„å»ºæ—¶é—´ä»10åˆ†é’Ÿé™è‡³1-2åˆ†é’Ÿ</p>
<h2 id="ï¿½ï¿½-æ€§èƒ½æå‡å¯¹æ¯”"><a href="#ï¿½ï¿½-æ€§èƒ½æå‡å¯¹æ¯”" class="headerlink" title="ï¿½ï¿½ æ€§èƒ½æå‡å¯¹æ¯”"></a>ï¿½ï¿½ æ€§èƒ½æå‡å¯¹æ¯”</h2><table>
<thead>
<tr>
<th>æŒ‡æ ‡</th>
<th>ä¼˜åŒ–å‰</th>
<th>ä¼˜åŒ–å</th>
<th>æå‡å¹…åº¦</th>
</tr>
</thead>
<tbody><tr>
<td>é¦–æ¬¡æ„å»ºæ—¶é—´</td>
<td>15-20åˆ†é’Ÿ</td>
<td>3-5åˆ†é’Ÿ</td>
<td><strong>75%</strong></td>
</tr>
<tr>
<td>é‡å¤æ„å»ºæ—¶é—´</td>
<td>10-15åˆ†é’Ÿ</td>
<td>1-2åˆ†é’Ÿ</td>
<td><strong>90%</strong></td>
</tr>
<tr>
<td>é•œåƒæ‹‰å–é€Ÿåº¦</td>
<td>è¶…æ—¶å¤±è´¥</td>
<td>30ç§’å†…</td>
<td><strong>100%</strong></td>
</tr>
<tr>
<td>éƒ¨ç½²æˆåŠŸç‡</td>
<td>ä¸ç¨³å®š</td>
<td>95%+</td>
<td><strong>æ˜¾è‘—æå‡</strong></td>
</tr>
<tr>
<td>Mavenä¾èµ–ä¸‹è½½</td>
<td>5-10åˆ†é’Ÿ</td>
<td>1-2åˆ†é’Ÿ</td>
<td><strong>80%</strong></td>
</tr>
</tbody></table>
<h2 id="ï¿½ï¿½ï¸-éƒ¨ç½²è„šæœ¬"><a href="#ï¿½ï¿½ï¸-éƒ¨ç½²è„šæœ¬" class="headerlink" title="ï¿½ï¿½ï¸ éƒ¨ç½²è„šæœ¬"></a>ï¿½ï¿½ï¸ éƒ¨ç½²è„šæœ¬</h2><h3 id="ä¸€é”®éƒ¨ç½²è„šæœ¬"><a href="#ä¸€é”®éƒ¨ç½²è„šæœ¬" class="headerlink" title="ä¸€é”®éƒ¨ç½²è„šæœ¬"></a>ä¸€é”®éƒ¨ç½²è„šæœ¬</h3><pre><code class="highlight bash"><span class="meta">#!/bin/bash</span>

<span class="comment"># éƒ¨ç½²è„šæœ¬</span>
<span class="comment"># ä½¿ç”¨æ–¹æ³•: ./scripts/deploy.sh [ç¯å¢ƒ]</span>

<span class="built_in">set</span> -e

<span class="comment"># é¢œè‰²å®šä¹‰</span>
RED=<span class="string">&#x27;\033[0;31m&#x27;</span>
GREEN=<span class="string">&#x27;\033[0;32m&#x27;</span>
YELLOW=<span class="string">&#x27;\033[1;33m&#x27;</span>
NC=<span class="string">&#x27;\033[0m&#x27;</span> <span class="comment"># No Color</span>

<span class="comment"># æ—¥å¿—å‡½æ•°</span>
<span class="function"><span class="title">log_info</span></span>() &#123;
    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;GREEN&#125;</span>[INFO]<span class="variable">$&#123;NC&#125;</span> <span class="variable">$1</span>&quot;</span>
&#125;

<span class="function"><span class="title">log_warn</span></span>() &#123;
    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;YELLOW&#125;</span>[WARN]<span class="variable">$&#123;NC&#125;</span> <span class="variable">$1</span>&quot;</span>
&#125;

<span class="function"><span class="title">log_error</span></span>() &#123;
    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;RED&#125;</span>[ERROR]<span class="variable">$&#123;NC&#125;</span> <span class="variable">$1</span>&quot;</span>
&#125;

<span class="comment"># è·å–ç¯å¢ƒå‚æ•°</span>
ENVIRONMENT=<span class="variable">$&#123;1:-prod&#125;</span>
PROJECT_DIR=<span class="string">&quot;<span class="subst">$(cd <span class="string">&quot;<span class="subst">$(dirname <span class="string">&quot;<span class="variable">$&#123;BASH_SOURCE[0]&#125;</span>&quot;</span>)</span>/..&quot;</span> &amp;&amp; pwd)</span>&quot;</span>

log_info <span class="string">&quot;å¼€å§‹éƒ¨ç½²åˆ° <span class="variable">$ENVIRONMENT</span> ç¯å¢ƒ...&quot;</span>

<span class="comment"># æ£€æŸ¥Dockeræ˜¯å¦è¿è¡Œ</span>
<span class="keyword">if</span> ! docker info &gt; /dev/null 2&gt;&amp;1; <span class="keyword">then</span>
    log_error <span class="string">&quot;Dockeræœªè¿è¡Œï¼Œè¯·å…ˆå¯åŠ¨Docker&quot;</span>
    <span class="built_in">exit</span> 1
<span class="keyword">fi</span>

<span class="comment"># æ£€æŸ¥ç½‘ç»œè¿æ¥</span>
log_info <span class="string">&quot;æ£€æŸ¥ç½‘ç»œè¿æ¥...&quot;</span>
<span class="keyword">if</span> ! curl -s --connect-timeout 10 https://mirrors.cloud.tencent.com &gt; /dev/null; <span class="keyword">then</span>
    log_warn <span class="string">&quot;ç½‘ç»œè¿æ¥å¯èƒ½æœ‰é—®é¢˜ï¼Œå»ºè®®å…ˆé…ç½®Dockeré•œåƒåŠ é€Ÿå™¨&quot;</span>
    log_info <span class="string">&quot;è¿è¡Œ: ./scripts/setup-docker.sh&quot;</span>
<span class="keyword">fi</span>

<span class="comment"># æ£€æŸ¥docker-composeæ˜¯å¦å®‰è£…</span>
<span class="keyword">if</span> ! <span class="built_in">command</span> -v docker-compose &amp;&gt; /dev/null; <span class="keyword">then</span>
    log_error <span class="string">&quot;docker-composeæœªå®‰è£…ï¼Œè¯·å…ˆå®‰è£…docker-compose&quot;</span>
    <span class="built_in">exit</span> 1
<span class="keyword">fi</span>

<span class="comment"># è¿›å…¥é¡¹ç›®ç›®å½•</span>
<span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$PROJECT_DIR</span>&quot;</span>

<span class="comment"># æ£€æŸ¥ç¯å¢ƒé…ç½®æ–‡ä»¶</span>
ENV_FILE=<span class="string">&quot;.env.<span class="variable">$ENVIRONMENT</span>&quot;</span>
<span class="keyword">if</span> [ ! -f <span class="string">&quot;<span class="variable">$ENV_FILE</span>&quot;</span> ]; <span class="keyword">then</span>
    log_warn <span class="string">&quot;ç¯å¢ƒé…ç½®æ–‡ä»¶ <span class="variable">$ENV_FILE</span> ä¸å­˜åœ¨ï¼Œä½¿ç”¨é»˜è®¤é…ç½®&quot;</span>
    ENV_FILE=<span class="string">&quot;.env&quot;</span>
<span class="keyword">fi</span>

<span class="comment"># åŠ è½½ç¯å¢ƒå˜é‡</span>
<span class="keyword">if</span> [ -f <span class="string">&quot;<span class="variable">$ENV_FILE</span>&quot;</span> ]; <span class="keyword">then</span>
    log_info <span class="string">&quot;åŠ è½½ç¯å¢ƒé…ç½®: <span class="variable">$ENV_FILE</span>&quot;</span>
    <span class="built_in">export</span> $(<span class="built_in">cat</span> <span class="string">&quot;<span class="variable">$ENV_FILE</span>&quot;</span> | grep -v <span class="string">&#x27;^#&#x27;</span> | xargs)
<span class="keyword">fi</span>

<span class="comment"># åœæ­¢ç°æœ‰æœåŠ¡</span>
log_info <span class="string">&quot;åœæ­¢ç°æœ‰æœåŠ¡...&quot;</span>
docker-compose -f docker/docker-compose.yml down

<span class="comment"># æ¸…ç†æ—§é•œåƒï¼ˆå¯é€‰ï¼‰</span>
<span class="keyword">if</span> [ <span class="string">&quot;<span class="variable">$2</span>&quot;</span> == <span class="string">&quot;--clean&quot;</span> ]; <span class="keyword">then</span>
    log_info <span class="string">&quot;æ¸…ç†æ—§é•œåƒ...&quot;</span>
    docker system prune -f
<span class="keyword">fi</span>

<span class="comment"># æ„å»ºé•œåƒ</span>
log_info <span class="string">&quot;æ„å»ºDockeré•œåƒ...&quot;</span>
MAX_RETRIES=3
RETRY_COUNT=0

<span class="keyword">while</span> [ <span class="variable">$RETRY_COUNT</span> -lt <span class="variable">$MAX_RETRIES</span> ]; <span class="keyword">do</span>
    <span class="keyword">if</span> docker-compose -f docker/docker-compose.yml build --no-cache; <span class="keyword">then</span>
        log_info <span class="string">&quot;âœ… Dockeré•œåƒæ„å»ºæˆåŠŸ&quot;</span>
        <span class="built_in">break</span>
    <span class="keyword">else</span>
        RETRY_COUNT=$((RETRY_COUNT + <span class="number">1</span>))
        <span class="keyword">if</span> [ <span class="variable">$RETRY_COUNT</span> -lt <span class="variable">$MAX_RETRIES</span> ]; <span class="keyword">then</span>
            log_warn <span class="string">&quot;æ„å»ºå¤±è´¥ï¼Œé‡è¯• <span class="variable">$RETRY_COUNT</span>/<span class="variable">$MAX_RETRIES</span>...&quot;</span>
            <span class="built_in">sleep</span> 10
        <span class="keyword">else</span>
            log_error <span class="string">&quot;âŒ Dockeré•œåƒæ„å»ºå¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°&quot;</span>
            log_info <span class="string">&quot;å»ºè®®æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è¿è¡Œ: ./scripts/setup-docker.sh&quot;</span>
            <span class="built_in">exit</span> 1
        <span class="keyword">fi</span>
    <span class="keyword">fi</span>
<span class="keyword">done</span>

<span class="comment"># å¯åŠ¨æœåŠ¡</span>
log_info <span class="string">&quot;å¯åŠ¨æœåŠ¡...&quot;</span>
docker-compose -f docker/docker-compose.yml up -d

<span class="comment"># ç­‰å¾…æœåŠ¡å¯åŠ¨</span>
log_info <span class="string">&quot;ç­‰å¾…æœåŠ¡å¯åŠ¨...&quot;</span>
<span class="built_in">sleep</span> 30

<span class="comment"># å¥åº·æ£€æŸ¥</span>
log_info <span class="string">&quot;æ‰§è¡Œå¥åº·æ£€æŸ¥...&quot;</span>
<span class="keyword">if</span> ./scripts/health-check.sh; <span class="keyword">then</span>
    log_info <span class="string">&quot;âœ… éƒ¨ç½²æˆåŠŸï¼&quot;</span>
    
    <span class="comment"># æ˜¾ç¤ºæœåŠ¡çŠ¶æ€</span>
    log_info <span class="string">&quot;æœåŠ¡çŠ¶æ€ï¼š&quot;</span>
    docker-compose -f docker/docker-compose.yml ps
    
    <span class="comment"># æ˜¾ç¤ºè®¿é—®ä¿¡æ¯</span>
    log_info <span class="string">&quot;è®¿é—®ä¿¡æ¯ï¼š&quot;</span>
    <span class="built_in">echo</span> <span class="string">&quot;  - åº”ç”¨åœ°å€: http://localhost:8080/api&quot;</span>
    <span class="built_in">echo</span> <span class="string">&quot;  - å¥åº·æ£€æŸ¥: http://localhost:8080/api/actuator/health&quot;</span>
    <span class="built_in">echo</span> <span class="string">&quot;  - APIæ–‡æ¡£: http://localhost:8080/api/swagger-ui.html&quot;</span>
    
<span class="keyword">else</span>
    log_error <span class="string">&quot;âŒ å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œéƒ¨ç½²å¯èƒ½æœ‰é—®é¢˜&quot;</span>
    log_info <span class="string">&quot;æŸ¥çœ‹æ—¥å¿—ï¼š&quot;</span>
    docker-compose -f docker/docker-compose.yml logs backend
    <span class="built_in">exit</span> 1
<span class="keyword">fi</span></code></pre>

<h3 id="å¥åº·æ£€æŸ¥è„šæœ¬"><a href="#å¥åº·æ£€æŸ¥è„šæœ¬" class="headerlink" title="å¥åº·æ£€æŸ¥è„šæœ¬"></a>å¥åº·æ£€æŸ¥è„šæœ¬</h3><pre><code class="highlight bash"><span class="meta">#!/bin/bash</span>

<span class="comment"># å¥åº·æ£€æŸ¥è„šæœ¬</span>
<span class="comment"># ä½¿ç”¨æ–¹æ³•: ./scripts/health-check.sh</span>

<span class="built_in">set</span> -e

<span class="comment"># é¢œè‰²å®šä¹‰</span>
RED=<span class="string">&#x27;\033[0;31m&#x27;</span>
GREEN=<span class="string">&#x27;\033[0;32m&#x27;</span>
YELLOW=<span class="string">&#x27;\033[1;33m&#x27;</span>
NC=<span class="string">&#x27;\033[0m&#x27;</span> <span class="comment"># No Color</span>

<span class="comment"># æ—¥å¿—å‡½æ•°</span>
<span class="function"><span class="title">log_info</span></span>() &#123;
    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;GREEN&#125;</span>[INFO]<span class="variable">$&#123;NC&#125;</span> <span class="variable">$1</span>&quot;</span>
&#125;

<span class="function"><span class="title">log_warn</span></span>() &#123;
    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;YELLOW&#125;</span>[WARN]<span class="variable">$&#123;NC&#125;</span> <span class="variable">$1</span>&quot;</span>
&#125;

<span class="function"><span class="title">log_error</span></span>() &#123;
    <span class="built_in">echo</span> -e <span class="string">&quot;<span class="variable">$&#123;RED&#125;</span>[ERROR]<span class="variable">$&#123;NC&#125;</span> <span class="variable">$1</span>&quot;</span>
&#125;

<span class="comment"># é…ç½®</span>
MAX_RETRIES=10
RETRY_INTERVAL=10
HEALTH_URL=<span class="string">&quot;http://localhost:8080/api/actuator/health&quot;</span>

log_info <span class="string">&quot;å¼€å§‹å¥åº·æ£€æŸ¥...&quot;</span>

<span class="comment"># æ£€æŸ¥Dockerå®¹å™¨çŠ¶æ€</span>
log_info <span class="string">&quot;æ£€æŸ¥Dockerå®¹å™¨çŠ¶æ€...&quot;</span>
<span class="keyword">if</span> ! docker-compose -f docker/docker-compose.yml ps | grep -q <span class="string">&quot;Up&quot;</span>; <span class="keyword">then</span>
    log_error <span class="string">&quot;Dockerå®¹å™¨æœªè¿è¡Œ&quot;</span>
    <span class="built_in">exit</span> 1
<span class="keyword">fi</span>

<span class="comment"># æ£€æŸ¥åç«¯åº”ç”¨å¥åº·çŠ¶æ€</span>
log_info <span class="string">&quot;æ£€æŸ¥åç«¯åº”ç”¨å¥åº·çŠ¶æ€...&quot;</span>
RETRY_COUNT=0

<span class="keyword">while</span> [ <span class="variable">$RETRY_COUNT</span> -lt <span class="variable">$MAX_RETRIES</span> ]; <span class="keyword">do</span>
    <span class="keyword">if</span> curl -f -s <span class="string">&quot;<span class="variable">$HEALTH_URL</span>&quot;</span> &gt; /dev/null 2&gt;&amp;1; <span class="keyword">then</span>
        log_info <span class="string">&quot;âœ… åç«¯åº”ç”¨å¥åº·æ£€æŸ¥é€šè¿‡&quot;</span>
        <span class="built_in">break</span>
    <span class="keyword">else</span>
        RETRY_COUNT=$((RETRY_COUNT + <span class="number">1</span>))
        log_warn <span class="string">&quot;å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œé‡è¯• <span class="variable">$RETRY_COUNT</span>/<span class="variable">$MAX_RETRIES</span>...&quot;</span>
        <span class="built_in">sleep</span> <span class="variable">$RETRY_INTERVAL</span>
    <span class="keyword">fi</span>
<span class="keyword">done</span>

<span class="keyword">if</span> [ <span class="variable">$RETRY_COUNT</span> -eq <span class="variable">$MAX_RETRIES</span> ]; <span class="keyword">then</span>
    log_error <span class="string">&quot;âŒ å¥åº·æ£€æŸ¥å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°&quot;</span>
    <span class="built_in">exit</span> 1
<span class="keyword">fi</span>

<span class="comment"># æ£€æŸ¥æ•°æ®åº“è¿æ¥</span>
log_info <span class="string">&quot;æ£€æŸ¥æ•°æ®åº“è¿æ¥...&quot;</span>
<span class="keyword">if</span> docker-compose -f docker/docker-compose.yml <span class="built_in">exec</span> -T mysql mysqladmin ping -h localhost --silent; <span class="keyword">then</span>
    log_info <span class="string">&quot;âœ… æ•°æ®åº“è¿æ¥æ­£å¸¸&quot;</span>
<span class="keyword">else</span>
    log_error <span class="string">&quot;âŒ æ•°æ®åº“è¿æ¥å¤±è´¥&quot;</span>
    <span class="built_in">exit</span> 1
<span class="keyword">fi</span>

<span class="comment"># æ£€æŸ¥Redisè¿æ¥</span>
log_info <span class="string">&quot;æ£€æŸ¥Redisè¿æ¥...&quot;</span>
<span class="keyword">if</span> docker-compose -f docker/docker-compose.yml <span class="built_in">exec</span> -T redis redis-cli ping | grep -q <span class="string">&quot;PONG&quot;</span>; <span class="keyword">then</span>
    log_info <span class="string">&quot;âœ… Redisè¿æ¥æ­£å¸¸&quot;</span>
<span class="keyword">else</span>
    log_error <span class="string">&quot;âŒ Redisè¿æ¥å¤±è´¥&quot;</span>
    <span class="built_in">exit</span> 1
<span class="keyword">fi</span>

<span class="comment"># æ£€æŸ¥åº”ç”¨æ—¥å¿—</span>
log_info <span class="string">&quot;æ£€æŸ¥åº”ç”¨æ—¥å¿—...&quot;</span>
<span class="keyword">if</span> docker-compose -f docker/docker-compose.yml logs backend | grep -q <span class="string">&quot;Started TeacherOnCallApplication&quot;</span>; <span class="keyword">then</span>
    log_info <span class="string">&quot;âœ… åº”ç”¨å¯åŠ¨æˆåŠŸ&quot;</span>
<span class="keyword">else</span>
    log_warn <span class="string">&quot;âš ï¸  åº”ç”¨å¯åŠ¨æ—¥å¿—æœªæ‰¾åˆ°ï¼Œè¯·æ£€æŸ¥æ—¥å¿—&quot;</span>
<span class="keyword">fi</span>

<span class="comment"># æ˜¾ç¤ºæœåŠ¡çŠ¶æ€</span>
log_info <span class="string">&quot;æœåŠ¡çŠ¶æ€ï¼š&quot;</span>
docker-compose -f docker/docker-compose.yml ps

<span class="comment"># æ˜¾ç¤ºèµ„æºä½¿ç”¨æƒ…å†µ</span>
log_info <span class="string">&quot;èµ„æºä½¿ç”¨æƒ…å†µï¼š&quot;</span>
docker stats --no-stream --format <span class="string">&quot;table &#123;&#123;.Container&#125;&#125;\t&#123;&#123;.CPUPerc&#125;&#125;\t&#123;&#123;.MemUsage&#125;&#125;\t&#123;&#123;.NetIO&#125;&#125;\t&#123;&#123;.BlockIO&#125;&#125;&quot;</span>

log_info <span class="string">&quot;âœ… æ‰€æœ‰å¥åº·æ£€æŸ¥é€šè¿‡ï¼&quot;</span></code></pre>

<h2 id="ğŸš€-ä½¿ç”¨æŒ‡å—"><a href="#ğŸš€-ä½¿ç”¨æŒ‡å—" class="headerlink" title="ğŸš€ ä½¿ç”¨æŒ‡å—"></a>ğŸš€ ä½¿ç”¨æŒ‡å—</h2><h3 id="1-ç¯å¢ƒå‡†å¤‡"><a href="#1-ç¯å¢ƒå‡†å¤‡" class="headerlink" title="1. ç¯å¢ƒå‡†å¤‡"></a>1. ç¯å¢ƒå‡†å¤‡</h3><h4 id="æœåŠ¡å™¨è¦æ±‚"><a href="#æœåŠ¡å™¨è¦æ±‚" class="headerlink" title="æœåŠ¡å™¨è¦æ±‚"></a>æœåŠ¡å™¨è¦æ±‚</h4><ul>
<li>LinuxæœåŠ¡å™¨ï¼ˆæ¨èUbuntu 20.04+ï¼‰</li>
<li>Docker Engine 20.10+</li>
<li>Docker Compose 2.0+</li>
<li>Git 2.0+</li>
</ul>
<h4 id="å®‰è£…Docker"><a href="#å®‰è£…Docker" class="headerlink" title="å®‰è£…Docker"></a>å®‰è£…Docker</h4><pre><code class="highlight bash"><span class="comment"># å®‰è£…Docker</span>
curl -fsSL https://get.docker.com -o get-docker.sh
<span class="built_in">sudo</span> sh get-docker.sh

<span class="comment"># å®‰è£…Docker Compose</span>
<span class="built_in">sudo</span> curl -L <span class="string">&quot;https://github.com/docker/compose/releases/download/v2.20.0/docker-compose-<span class="subst">$(uname -s)</span>-<span class="subst">$(uname -m)</span>&quot;</span> -o /usr/local/bin/docker-compose
<span class="built_in">sudo</span> <span class="built_in">chmod</span> +x /usr/local/bin/docker-compose

<span class="comment"># å¯åŠ¨DockeræœåŠ¡</span>
<span class="built_in">sudo</span> systemctl start docker
<span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> docker

<span class="comment"># é…ç½®Dockeré•œåƒåŠ é€Ÿå™¨ï¼ˆé‡è¦ï¼ï¼‰</span>
./scripts/setup-docker.sh</code></pre>

<h3 id="2-é…ç½®ç¯å¢ƒå˜é‡"><a href="#2-é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="2. é…ç½®ç¯å¢ƒå˜é‡"></a>2. é…ç½®ç¯å¢ƒå˜é‡</h3><h4 id="åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®"><a href="#åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®" class="headerlink" title="åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®"></a>åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®</h4><pre><code class="highlight bash"><span class="comment"># å¤åˆ¶é…ç½®ç¤ºä¾‹æ–‡ä»¶</span>
<span class="built_in">cp</span> env.prod.example .env.prod

<span class="comment"># ç¼–è¾‘é…ç½®æ–‡ä»¶</span>
nano .env.prod</code></pre>

<h4 id="é…ç½®GitHub-Secrets"><a href="#é…ç½®GitHub-Secrets" class="headerlink" title="é…ç½®GitHub Secrets"></a>é…ç½®GitHub Secrets</h4><p>åœ¨GitHubä»“åº“è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹Secretsï¼š</p>
<ul>
<li><code>HOST</code>: æœåŠ¡å™¨IPåœ°å€</li>
<li><code>USERNAME</code>: æœåŠ¡å™¨ç”¨æˆ·å</li>
<li><code>PASSWORD</code>: æœåŠ¡å™¨å¯†ç </li>
<li><code>PORT</code>: SSHç«¯å£ï¼ˆé»˜è®¤22ï¼‰</li>
</ul>
<h3 id="3-é¦–æ¬¡éƒ¨ç½²"><a href="#3-é¦–æ¬¡éƒ¨ç½²" class="headerlink" title="3. é¦–æ¬¡éƒ¨ç½²"></a>3. é¦–æ¬¡éƒ¨ç½²</h3><pre><code class="highlight bash"><span class="comment"># åœ¨æœåŠ¡å™¨ä¸Šå…‹éš†ä»£ç </span>
git <span class="built_in">clone</span> https://github.com/your-username/teacher-on-call.git
<span class="built_in">cd</span> teacher-on-call

<span class="comment"># é…ç½®ç¯å¢ƒå˜é‡</span>
<span class="built_in">cp</span> env.prod.example .env.prod
nano .env.prod

<span class="comment"># æ‰§è¡Œéƒ¨ç½²è„šæœ¬</span>
./scripts/deploy.sh prod</code></pre>

<h3 id="4-è‡ªåŠ¨åŒ–éƒ¨ç½²"><a href="#4-è‡ªåŠ¨åŒ–éƒ¨ç½²" class="headerlink" title="4. è‡ªåŠ¨åŒ–éƒ¨ç½²"></a>4. è‡ªåŠ¨åŒ–éƒ¨ç½²</h3><pre><code class="highlight bash"><span class="comment"># æ¨é€ä»£ç åˆ°mainåˆ†æ”¯</span>
git add .
git commit -m <span class="string">&quot;feat: æ·»åŠ æ–°åŠŸèƒ½&quot;</span>
git push origin main</code></pre>

<h2 id="ğŸ“ˆ-ç›‘æ§å’Œæ—¥å¿—"><a href="#ğŸ“ˆ-ç›‘æ§å’Œæ—¥å¿—" class="headerlink" title="ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—"></a>ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—</h2><h3 id="åº”ç”¨ç›‘æ§"><a href="#åº”ç”¨ç›‘æ§" class="headerlink" title="åº”ç”¨ç›‘æ§"></a>åº”ç”¨ç›‘æ§</h3><ul>
<li><strong>å¥åº·æ£€æŸ¥</strong>: <code>http://your-server:8080/api/actuator/health</code></li>
<li><strong>æŒ‡æ ‡ç›‘æ§</strong>: <code>http://your-server:8080/api/actuator/metrics</code></li>
<li><strong>APIæ–‡æ¡£</strong>: <code>http://your-server:8080/api/swagger-ui.html</code></li>
</ul>
<h3 id="æ—¥å¿—æŸ¥çœ‹"><a href="#æ—¥å¿—æŸ¥çœ‹" class="headerlink" title="æ—¥å¿—æŸ¥çœ‹"></a>æ—¥å¿—æŸ¥çœ‹</h3><pre><code class="highlight bash"><span class="comment"># æŸ¥çœ‹åº”ç”¨æ—¥å¿—</span>
docker-compose -f docker/docker-compose.yml logs -f backend

<span class="comment"># æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—</span>
docker-compose -f docker/docker-compose.yml logs -f mysql

<span class="comment"># æŸ¥çœ‹Redisæ—¥å¿—</span>
docker-compose -f docker/docker-compose.yml logs -f redis</code></pre>

<h3 id="èµ„æºç›‘æ§"><a href="#èµ„æºç›‘æ§" class="headerlink" title="èµ„æºç›‘æ§"></a>èµ„æºç›‘æ§</h3><pre><code class="highlight bash"><span class="comment"># æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨æƒ…å†µ</span>
docker stats

<span class="comment"># æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µ</span>
htop</code></pre>

<h2 id="ğŸ”-å®‰å…¨å»ºè®®"><a href="#ğŸ”-å®‰å…¨å»ºè®®" class="headerlink" title="ğŸ” å®‰å…¨å»ºè®®"></a>ğŸ” å®‰å…¨å»ºè®®</h2><h3 id="1-ç¯å¢ƒå˜é‡å®‰å…¨"><a href="#1-ç¯å¢ƒå˜é‡å®‰å…¨" class="headerlink" title="1. ç¯å¢ƒå˜é‡å®‰å…¨"></a>1. ç¯å¢ƒå˜é‡å®‰å…¨</h3><ul>
<li>ä½¿ç”¨å¼ºå¯†ç </li>
<li>å®šæœŸæ›´æ¢å¯†é’¥</li>
<li>ä¸è¦å°†æ•æ„Ÿä¿¡æ¯æäº¤åˆ°ä»£ç ä»“åº“</li>
</ul>
<h3 id="2-ç½‘ç»œå®‰å…¨"><a href="#2-ç½‘ç»œå®‰å…¨" class="headerlink" title="2. ç½‘ç»œå®‰å…¨"></a>2. ç½‘ç»œå®‰å…¨</h3><ul>
<li>é…ç½®é˜²ç«å¢™è§„åˆ™</li>
<li>ä½¿ç”¨HTTPS</li>
<li>é™åˆ¶æ•°æ®åº“å’ŒRedisçš„å¤–éƒ¨è®¿é—®</li>
</ul>
<h3 id="3-å®¹å™¨å®‰å…¨"><a href="#3-å®¹å™¨å®‰å…¨" class="headerlink" title="3. å®¹å™¨å®‰å…¨"></a>3. å®¹å™¨å®‰å…¨</h3><ul>
<li>å®šæœŸæ›´æ–°åŸºç¡€é•œåƒ</li>
<li>ä½¿ç”¨érootç”¨æˆ·è¿è¡Œåº”ç”¨</li>
<li>æ‰«æé•œåƒæ¼æ´</li>
</ul>
<h2 id="ï¿½ï¿½-æ€»ç»“"><a href="#ï¿½ï¿½-æ€»ç»“" class="headerlink" title="ï¿½ï¿½ æ€»ç»“"></a>ï¿½ï¿½ æ€»ç»“</h2><p>é€šè¿‡æœ¬æ–‡çš„å®è·µï¼Œæˆ‘ä»¬æˆåŠŸæ­å»ºäº†ä¸€å¥—å®Œæ•´çš„Spring Booté¡¹ç›®CI&#x2F;CDæµæ°´çº¿ï¼Œä¸»è¦æˆæœåŒ…æ‹¬ï¼š</p>
<h3 id="âœ…-æŠ€æœ¯æˆæœ"><a href="#âœ…-æŠ€æœ¯æˆæœ" class="headerlink" title="âœ… æŠ€æœ¯æˆæœ"></a>âœ… æŠ€æœ¯æˆæœ</h3><ul>
<li><strong>è‡ªåŠ¨åŒ–æ„å»º</strong>ï¼šä»£ç æ¨é€åè‡ªåŠ¨æ„å»ºå’Œæµ‹è¯•</li>
<li><strong>Dockerå®¹å™¨åŒ–</strong>ï¼šå®Œæ•´çš„æœåŠ¡ç¼–æ’å’Œå¥åº·æ£€æŸ¥</li>
<li><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼šæ„å»ºé€Ÿåº¦æå‡75%+ï¼Œéƒ¨ç½²æˆåŠŸç‡95%+</li>
<li><strong>ç½‘ç»œä¼˜åŒ–</strong>ï¼šé€šè¿‡è…¾è®¯äº‘é•œåƒåŠ é€Ÿè§£å†³ç½‘ç»œé—®é¢˜</li>
</ul>
<h3 id="âœ…-è¿ç»´æˆæœ"><a href="#âœ…-è¿ç»´æˆæœ" class="headerlink" title="âœ… è¿ç»´æˆæœ"></a>âœ… è¿ç»´æˆæœ</h3><ul>
<li><strong>ä¸€é”®éƒ¨ç½²</strong>ï¼šç®€å•çš„éƒ¨ç½²å‘½ä»¤ï¼Œé™ä½è¿ç»´å¤æ‚åº¦</li>
<li><strong>å¥åº·æ£€æŸ¥</strong>ï¼šè‡ªåŠ¨æ£€æµ‹æœåŠ¡çŠ¶æ€ï¼Œæé«˜ç³»ç»Ÿå¯é æ€§</li>
<li><strong>æ—¥å¿—ç®¡ç†</strong>ï¼šå®Œæ•´çš„æ—¥å¿—æŸ¥çœ‹å’Œæ•…éšœæ’æŸ¥ä½“ç³»</li>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šSpring Boot Actuatoræä¾›ä¸°å¯Œçš„ç›‘æ§æŒ‡æ ‡</li>
</ul>
<h3 id="âœ…-å¼€å‘ä½“éªŒ"><a href="#âœ…-å¼€å‘ä½“éªŒ" class="headerlink" title="âœ… å¼€å‘ä½“éªŒ"></a>âœ… å¼€å‘ä½“éªŒ</h3><ul>
<li><strong>å¿«é€Ÿåé¦ˆ</strong>ï¼š3-5åˆ†é’Ÿå®Œæˆå®Œæ•´éƒ¨ç½²</li>
<li><strong>ç¯å¢ƒä¸€è‡´</strong>ï¼šDockerç¡®ä¿å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒä¸€è‡´</li>
<li><strong>æ•…éšœæ’æŸ¥</strong>ï¼šå®Œæ•´çš„æ—¥å¿—å’Œç›‘æ§ä½“ç³»ï¼Œå¿«é€Ÿå®šä½é—®é¢˜</li>
</ul>
<h3 id="ï¿½ï¿½-ä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘"><a href="#ï¿½ï¿½-ä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘" class="headerlink" title="ï¿½ï¿½ ä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘"></a>ï¿½ï¿½ ä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘</h3><ol>
<li><strong>ç›‘æ§å‘Šè­¦</strong>ï¼šé›†æˆPrometheus + Grafanaç›‘æ§ä½“ç³»</li>
<li><strong>æ—¥å¿—èšåˆ</strong>ï¼šä½¿ç”¨ELK Stackè¿›è¡Œæ—¥å¿—èšåˆåˆ†æ</li>
<li><strong>æ€§èƒ½è°ƒä¼˜</strong>ï¼šæ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´JVMå‚æ•°</li>
<li><strong>å¤‡ä»½ç­–ç•¥</strong>ï¼šé…ç½®æ•°æ®åº“å’ŒRedisçš„è‡ªåŠ¨å¤‡ä»½</li>
<li><strong>å®‰å…¨åŠ å›º</strong>ï¼šé›†æˆå®‰å…¨æ‰«æå’Œæ¼æ´æ£€æµ‹</li>
</ol>
<p>è¿™å¥—CI&#x2F;CDæµæ°´çº¿ä¸ä»…è§£å†³äº†å½“å‰çš„éƒ¨ç½²éœ€æ±‚ï¼Œæ›´ä¸ºé¡¹ç›®çš„é•¿æœŸå‘å±•å¥ å®šäº†åšå®çš„æŠ€æœ¯åŸºç¡€ã€‚é€šè¿‡æŒç»­ä¼˜åŒ–å’Œæ”¹è¿›ï¼Œå¯ä»¥è¿›ä¸€æ­¥æå‡å¼€å‘æ•ˆç‡å’Œç³»ç»Ÿç¨³å®šæ€§ã€‚</p>
<hr>
<p><strong>å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹æ‚¨æ­å»ºCI&#x2F;CDæµæ°´çº¿æœ‰æ‰€å¸®åŠ©ï¼å¦‚æœæ‚¨æœ‰ä»»ä½•é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºäº¤æµè®¨è®ºã€‚</strong> ğŸŠ</p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/briefing/">Briefing</a></li>
        
          <li><a href="/projects/">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E4%BD%93%E6%80%9D%E8%B7%AF"><span class="toc-number">1.</span> <span class="toc-text">æ•´ä½“æ€è·¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6"><span class="toc-number">2.</span> <span class="toc-text">ğŸš€ æ ¸å¿ƒç»„ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Docker%E5%AE%B9%E5%99%A8%E5%8C%96%E7%AD%96%E7%95%A5"><span class="toc-number">2.1.</span> <span class="toc-text">1. Dockerå®¹å™¨åŒ–ç­–ç•¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E9%98%B6%E6%AE%B5%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">2.1.1.</span> <span class="toc-text">å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Docker-Compose%E6%9C%8D%E5%8A%A1%E7%BC%96%E6%8E%92"><span class="toc-number">2.1.2.</span> <span class="toc-text">Docker ComposeæœåŠ¡ç¼–æ’</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-GitHub-Actions%E5%B7%A5%E4%BD%9C%E6%B5%81"><span class="toc-number">2.2.</span> <span class="toc-text">2. GitHub Actionså·¥ä½œæµ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD-%E8%A7%A3%E5%86%B3%E7%9A%84%E5%85%B3%E9%94%AE%E6%8A%80%E6%9C%AF%E9%97%AE%E9%A2%98"><span class="toc-number">3.</span> <span class="toc-text">ï¿½ï¿½ è§£å†³çš„å…³é”®æŠ€æœ¯é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E9%97%AE%E9%A2%98"><span class="toc-number">3.1.</span> <span class="toc-text">1. ç½‘ç»œè¿æ¥é—®é¢˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Maven%E4%BE%9D%E8%B5%96%E4%B8%8B%E8%BD%BD%E4%BC%98%E5%8C%96"><span class="toc-number">3.2.</span> <span class="toc-text">2. Mavenä¾èµ–ä¸‹è½½ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-Docker%E6%9E%84%E5%BB%BA%E4%BC%98%E5%8C%96"><span class="toc-number">3.3.</span> <span class="toc-text">3. Dockeræ„å»ºä¼˜åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD-%E6%80%A7%E8%83%BD%E6%8F%90%E5%8D%87%E5%AF%B9%E6%AF%94"><span class="toc-number">4.</span> <span class="toc-text">ï¿½ï¿½ æ€§èƒ½æå‡å¯¹æ¯”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD%EF%B8%8F-%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC"><span class="toc-number">5.</span> <span class="toc-text">ï¿½ï¿½ï¸ éƒ¨ç½²è„šæœ¬</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E9%94%AE%E9%83%A8%E7%BD%B2%E8%84%9A%E6%9C%AC"><span class="toc-number">5.1.</span> <span class="toc-text">ä¸€é”®éƒ¨ç½²è„šæœ¬</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%81%A5%E5%BA%B7%E6%A3%80%E6%9F%A5%E8%84%9A%E6%9C%AC"><span class="toc-number">5.2.</span> <span class="toc-text">å¥åº·æ£€æŸ¥è„šæœ¬</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%9A%80-%E4%BD%BF%E7%94%A8%E6%8C%87%E5%8D%97"><span class="toc-number">6.</span> <span class="toc-text">ğŸš€ ä½¿ç”¨æŒ‡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E5%87%86%E5%A4%87"><span class="toc-number">6.1.</span> <span class="toc-text">1. ç¯å¢ƒå‡†å¤‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%A6%81%E6%B1%82"><span class="toc-number">6.1.1.</span> <span class="toc-text">æœåŠ¡å™¨è¦æ±‚</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Docker"><span class="toc-number">6.1.2.</span> <span class="toc-text">å®‰è£…Docker</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-number">6.2.</span> <span class="toc-text">2. é…ç½®ç¯å¢ƒå˜é‡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">6.2.1.</span> <span class="toc-text">åˆ›å»ºç”Ÿäº§ç¯å¢ƒé…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEGitHub-Secrets"><span class="toc-number">6.2.2.</span> <span class="toc-text">é…ç½®GitHub Secrets</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%A6%96%E6%AC%A1%E9%83%A8%E7%BD%B2"><span class="toc-number">6.3.</span> <span class="toc-text">3. é¦–æ¬¡éƒ¨ç½²</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2"><span class="toc-number">6.4.</span> <span class="toc-text">4. è‡ªåŠ¨åŒ–éƒ¨ç½²</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%93%88-%E7%9B%91%E6%8E%A7%E5%92%8C%E6%97%A5%E5%BF%97"><span class="toc-number">7.</span> <span class="toc-text">ğŸ“ˆ ç›‘æ§å’Œæ—¥å¿—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E7%9B%91%E6%8E%A7"><span class="toc-number">7.1.</span> <span class="toc-text">åº”ç”¨ç›‘æ§</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%9F%A5%E7%9C%8B"><span class="toc-number">7.2.</span> <span class="toc-text">æ—¥å¿—æŸ¥çœ‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B5%84%E6%BA%90%E7%9B%91%E6%8E%A7"><span class="toc-number">7.3.</span> <span class="toc-text">èµ„æºç›‘æ§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%F0%9F%94%90-%E5%AE%89%E5%85%A8%E5%BB%BA%E8%AE%AE"><span class="toc-number">8.</span> <span class="toc-text">ğŸ” å®‰å…¨å»ºè®®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%AE%89%E5%85%A8"><span class="toc-number">8.1.</span> <span class="toc-text">1. ç¯å¢ƒå˜é‡å®‰å…¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8"><span class="toc-number">8.2.</span> <span class="toc-text">2. ç½‘ç»œå®‰å…¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%AE%B9%E5%99%A8%E5%AE%89%E5%85%A8"><span class="toc-number">8.3.</span> <span class="toc-text">3. å®¹å™¨å®‰å…¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD-%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">ï¿½ï¿½ æ€»ç»“</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%85-%E6%8A%80%E6%9C%AF%E6%88%90%E6%9E%9C"><span class="toc-number">9.1.</span> <span class="toc-text">âœ… æŠ€æœ¯æˆæœ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%85-%E8%BF%90%E7%BB%B4%E6%88%90%E6%9E%9C"><span class="toc-number">9.2.</span> <span class="toc-text">âœ… è¿ç»´æˆæœ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E2%9C%85-%E5%BC%80%E5%8F%91%E4%BD%93%E9%AA%8C"><span class="toc-number">9.3.</span> <span class="toc-text">âœ… å¼€å‘ä½“éªŒ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%EF%BF%BD%EF%BF%BD-%E4%B8%8B%E4%B8%80%E6%AD%A5%E4%BC%98%E5%8C%96%E6%96%B9%E5%90%91"><span class="toc-number">9.4.</span> <span class="toc-text">ï¿½ï¿½ ä¸‹ä¸€æ­¥ä¼˜åŒ–æ–¹å‘</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&text=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&is_video=false&description=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=GitHub Actions CI-CDæµæ°´çº¿æ­å»º&body=Check out this article: https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&title=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&name=GitHub Actions CI-CDæµæ°´çº¿æ­å»º&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://jaryujun.github.io/2025/09/03/GitHub%20Actions%20CI-CD%E6%B5%81%E6%B0%B4%E7%BA%BF%E6%90%AD%E5%BB%BA/&t=GitHub Actions CI-CDæµæ°´çº¿æ­å»º"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2026
    Jaryujun
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/briefing/">Briefing</a></li><!--
     --><!--
       --><li><a href="/projects/">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
